<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Specific client application problems</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REL="HOME"
TITLE="Samba FAQ"
HREF="samba-faq.html"><LINK
REL="PREVIOUS"
TITLE="Configuration problems"
HREF="config.html"><LINK
REL="NEXT"
TITLE="Common errors"
HREF="errors.html"></HEAD
><BODY
CLASS="CHAPTER"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Samba FAQ</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="config.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="errors.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="CHAPTER"
><H1
><A
NAME="CLIENTAPP">Chapter 4. Specific client application problems</H1
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN174">4.1. MS Office Setup reports "Cannot change properties of '\MSOFFICE\SETUP.INI'"</H1
><P
>When installing MS Office on a Samba drive for which you have admin
user permissions, ie. admin users = username, you will find the
setup program unable to complete the installation.</P
><P
>To get around this problem, do the installation without admin user
permissions The problem is that MS Office Setup checks that a file is
rdonly by trying to open it for writing.</P
><P
>Admin users can always open a file for writing, as they run as root.
You just have to install as a non-admin user and then use "chown -R"
to fix the owner.</P
></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN179">4.2. How to use a Samba share as an administrative share for MS Office, etc.</H1
><P
>Microsoft Office products can be installed as an administrative installation
from which the application can either be run off the administratively installed
product that resides on a shared resource, or from which that product can be
installed onto workstation clients.</P
><P
>The general mechanism for implementing an adminstrative installation involves
running <B
CLASS="COMMAND"
>X:\setup /A</B
>, where X is the drive letter of either CDROM or floppy.</P
><P
>This installation process will NOT install the product for use per se, but
rather results in unpacking of the compressed distribution files into a target
shared folder. For this process you need write privilidge to the share and it
is desirable to enable file locking and share mode operation during this
process.</P
><P
>Subsequent installation of MS Office from this share will FAIL unless certain
precautions are taken. This failure will be caused by share mode operation
which will prevent the MS Office installation process from re-opening various
dynamic link library files and will cause sporadic file not found problems.</P
><P
></P
><UL
><LI
><P
>As soon as the administrative installation (unpacking) has completed
set the following parameters on the share containing it:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>	[MSOP95]
		path = /where_you_put_it
		comment = Your comment
		volume = "The_CD_ROM_Label"
		read only = yes
		available = yes
		share modes = no
		locking = no
		browseable = yes
		public = yes</PRE
></P
></LI
><LI
><P
>Now you are ready to run the setup program from the Microsoft Windows
workstation as follows: <B
CLASS="COMMAND"
>\\"Server_Name"\MSOP95\msoffice\setup</B
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN194">4.3. Microsoft Access database opening errors</H1
><P
>Here are some notes on running MS-Access on a Samba drive from <A
HREF="stefank@esi.com.au"
TARGET="_top"
>Stefan Kjellberg</A
></P
><P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>Opening a database in 'exclusive' mode does NOT work. Samba ignores r/w/share modes on file open.</TD
></TR
><TR
><TD
>Make sure that you open the database as 'shared' and to 'lock modified records'</TD
></TR
><TR
><TD
>Of course locking must be enabled for the particular share (smb.conf)</TD
></TR
></TBODY
></TABLE
><P
></P
></P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="config.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="samba-faq.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="errors.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Configuration problems</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Common errors</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>